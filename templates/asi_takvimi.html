<!DOCTYPE html>
<html lang="tr"><head><title>Aşı Takvimi</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"></head>
<body class="bg-light p-3"><div class="container">
    {% if current_user.role == 'calisan' %}<a href="/calisan/panel" class="btn btn-secondary mb-3">&larr; Dön</a>
    {% else %}<a href="/dashboard" class="btn btn-secondary mb-3">&larr; Dön</a>{% endif %}
    
    <div class="row">
        {% if current_user.role in ['vet', 'admin'] %}
        <div class="col-md-5 mb-3"><div class="card border-info"><div class="card-header bg-info text-white">Aşı Planla</div><div class="card-body">
            <ul class="nav nav-tabs" id="myTab"><li class="nav-item"><button class="nav-link active" data-bs-toggle="tab" data-bs-target="#tek">Tek</button></li><li class="nav-item"><button class="nav-link" data-bs-toggle="tab" data-bs-target="#top">Toplu</button></li></ul>
            <div class="tab-content pt-3">
                <div class="tab-pane fade show active" id="tek"><form method="POST">
                    <select name="hayvan_id" class="form-select mb-2">{% for h in hayvanlar %}<option value="{{ h.id }}">{{ h.kupe_no }} ({{ h.padok_no }})</option>{% endfor %}</select>
                    <input type="text" name="asi_adi" class="form-control mb-2" placeholder="Aşı Adı" required>
                    <input type="text" name="notlar" class="form-control mb-2" placeholder="Not">
                    <input type="date" name="planlanan_tarih" class="form-control mb-2" required>
                    <button class="btn btn-primary w-100">Planla</button>
                </form></div>
                <div class="tab-pane fade" id="top"><form method="POST">
                    <select name="grup_id" class="form-select mb-2">{% for g in gruplar %}<option value="{{ g.id }}">{{ g.ad }}</option>{% endfor %}</select>
                    <input type="text" name="asi_adi" class="form-control mb-2" placeholder="Aşı Adı" required>
                    <input type="text" name="notlar" class="form-control mb-2" placeholder="Not">
                    <input type="date" name="planlanan_tarih" class="form-control mb-2" required>
                    <button class="btn btn-danger w-100">Gruba Planla</button>
                </form></div>
            </div>
        </div></div></div>
        {% endif %}
        <div class="col-md-{% if current_user.role in ['vet', 'admin'] %}7{% else %}12{% endif %}"><div class="card"><div class="card-header bg-dark text-white">Bekleyen Aşılar</div>
            <table class="table mb-0 table-hover"><thead><tr><th>Tarih</th><th>Hayvan</th><th>Aşı</th><th>İşlem</th></tr></thead><tbody>
                {% for a in asilar %}
                <tr class="{% if a.planlanan_tarih < bugun %}table-danger{% elif a.planlanan_tarih == bugun %}table-warning{% else %}table-success{% endif %}">
                    <td>{{ a.planlanan_tarih }}</td><td>{{ a.hayvan.kupe_no }}</td>
                    <td><strong>{{ a.asi_adi }}</strong><br><small>{{ a.notlar }}</small></td>
                    <td><a href="/asi_yapildi/{{ a.id }}" class="btn btn-sm btn-primary" onclick="return confirm('Yapıldı mı?')">✅</a></td>
                </tr>
                {% else %}<tr><td colspan="4" class="text-center text-muted">Aşı yok.</td></tr>{% endfor %}
            </tbody></table>
        </div></div>
    </div>
</div><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script></body></html>